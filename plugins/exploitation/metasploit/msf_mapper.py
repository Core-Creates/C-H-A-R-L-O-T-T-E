# ******************************************************************************************
# msf_mapper.py
# Utility for mapping CVE IDs to Metasploit modules via RPC client
# ******************************************************************************************

def find_exploit_for_cve(client, cve_id):
    """
    Attempts to match a CVE ID to a Metasploit module using built-in search.

    Args:
        client (MsfRpcClient): Authenticated Metasploit RPC client
        cve_id (str): CVE identifier, e.g., "CVE-2021-4034"

    Returns:
        list: List of Metasploit module names (e.g., ['exploit/linux/local/pkexec'])
    """
    print(f"[*] Searching Metasploit modules for {cve_id}...")
    results = client.modules.search(cve_id)
    exploits = [r['fullname'] for r in results if r['type'] == 'exploit']
    if exploits:
        print(f"[+] Found matching exploit(s) for {cve_id}: {exploits}")
    else:
        print(f"[!] No Metasploit exploit found for {cve_id}")
    return exploits
